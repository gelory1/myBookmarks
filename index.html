<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>耿朋的导航</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <header></header>
    <main>
        <div id="mainDiv"></div>
    </main>
    <footer></footer>
<script>
//初始化
var hashA=init()
var hash=hashA.hash
var arr=hashA.arr
//生成键盘
generateKeyboard(arr,hash)
//监听事件
document.onkeypress=function(dfshgofabsgn){
    window.open('http://'+ hash[dfshgofabsgn.key],'_blank')
    }  
//工具函数
function generateKeyboard(arr,hash){
    for( index=0;index<arr.length;index++){
    var div1=tag('div',{className:'div1'})
    mainDiv.appendChild(div1)

    for(index2=0;index2<arr[index].length;index2++){
        var kbd1=tag('kbd',{className:'keyboard'})
        var span1=tag('span')
        var letter = arr[index][index2]
        span1.textContent=letter
        var button1=createButton(arr[index][index2])
        var img1=tag('img')
        img1.onerror=function(xxx){
            xxx.target.src = '//i.loli.net/2017/11/10/5a05afbc5e183.png'
        }
         if(hash[arr[index][index2]]){
            img1.src="http://"+hash[arr[index][index2]]+"/favicon.ico"
        }
        else{
            img1.src='//i.loli.net/2017/11/10/5a05afbc5e183.png'
        }
        div1.appendChild(kbd1)
        kbd1.appendChild(span1)
        kbd1.appendChild(button1)
        kbd1.appendChild(img1)
         
    }
    }
}    
function getFromLocalStorage(name){
        return JSON.parse(localStorage.getItem(name)||null)
}
function tag(tagName,attributes){
    var element = document.createElement(tagName)
    for(var key in attributes){
        element[key]=attributes[key]
    }
    return element
}
function createButton(id){
    var button1=tag('button',{textContent:'Edit'})
    button1.id=arr[index][index2]
    button1.onclick=function(dsdgadgdasg){
    var website=prompt('给我一个网址')
     var button2=dsdgadgdasg['target']
    var key=button2['id']
    var img2=button2.nextSibling
    hash[key]=website
    img2.src="http://"+hash[key]+"/favicon.ico"
    img2.onerror=function(xxx){
        xxx.target.src = '//i.loli.net/2017/11/10/5a05afbc5e183.png'
     }
    localStorage.setItem('xxx',JSON.stringify(hash))
    }
    return button1
}
function init(){
    var arr=[
        ['q','w','e','r','t','y','u','i','o','p'],
        ['a','s','d','f','g','h','j','k','l'],
        ['z','x','c','v','b','n','m']
    ]
    var hash={
        'q':'qq.com',
        'w':'weibo.com',
        't':'taobao.com',
        'a':'alibaba.com',
        'z':'zhihu.com',
        'x':'xunlei.com'   
    }
    var hashInLocalStorage=getFromLocalStorage('xxx')
    if (hashInLocalStorage){
        hash=hashInLocalStorage
    }
    return {
        "arr" : arr ,
        "hash" : hash
    }
}
</script>
</body>
</html>